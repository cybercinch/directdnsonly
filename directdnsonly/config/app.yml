---
timezone: Pacific/Auckland
log_level: INFO
queue_location: ./data/queues

# Application datastore — stores domain index and zone_data for healing/peer-sync.
# SQLite (default) requires no extra dependencies and is fine for single-node setups.
# MySQL is recommended for multi-node deployments with a shared datastore.
datastore:
  type: sqlite
  db_location: ./data/directdnsonly.db
  # --- MySQL ---
  # type: mysql
  # host: "127.0.0.1"
  # port: "3306"
  # name: "directdnsonly"
  # user: "directdnsonly"
  # pass: "changeme"

app:
  auth_username: directdnsonly
  auth_password: changeme  # Override via DADNS_APP_AUTH_PASSWORD env var

# Reconciliation poller — queries each DA server and removes orphaned zones
# Disabled by default. Only touches zones registered via DaDNS (in our DB).
# If a DA server is unreachable, that server is skipped entirely.
#reconciliation:
#  enabled: true
#  dry_run: true             # log orphans but do NOT queue deletes — safe first-run mode
#  interval_minutes: 60
#  initial_delay_minutes: 0  # stagger first run when running multiple receivers behind a LB
#                            # e.g. receiver-1: 0, receiver-2: 30 (half the interval)
#  verify_ssl: true          # set false for self-signed DA certs
#  ipp: 1000                 # items per page when polling DA (default 1000)
#  directadmin_servers:
#    - hostname: da1.example.com
#      port: 2222
#      username: admin
#      password: secret
#      ssl: true
#    - hostname: da2.example.com
#      port: 2222
#      username: admin
#      password: secret
#      ssl: true

# Peer sync — exchange zone_data between directdnsonly instances
# Enables eventual consistency without a shared datastore.
# If a peer is offline, the sync is silently skipped and retried next interval.
# Use the same credentials as the peer's app.auth_username / auth_password.
#peer_sync:
#  enabled: true
#  interval_minutes: 15
#  peers:
#    - url: http://ddo-2:2222   # URL of the peer directdnsonly instance
#      username: directdnsonly
#      password: changeme

dns:
  backends:
    bind:
      type: bind
      enabled: true
      zones_dir: ./data/zones
      named_conf: ./data/named.conf.include
    # nsd:
    #   type: nsd
    #   enabled: false
    #   zones_dir: /etc/nsd/zones
    #   nsd_conf: /etc/nsd/nsd.conf.d/zones.conf